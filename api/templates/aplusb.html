<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>欢迎寻找彩蛋</title>
    <script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.js"></script>
    <script src="https://cdn.bootcss.com/jquery-cookie/1.4.1/jquery.cookie.js"></script>
    <script>
        function ajax() {
            $.ajax({
                url: 'http://localhost:8000/hello/',
                type: 'GET',
                xhrFields: {
                   withCredentials: true
                },
                success: function () {
                    post(csrftoken);
                },
                error: function (data) {
                    alert("fuck");
                }
            });
        }
        function post(csrf) {
            $.ajax({
                url: 'http://localhost:8000/hello/',
                type: 'POST',
                xhrFields: {
                   withCredentials: true
                },
                headers: {
                    "X-CSRFToken": $.cookie("csrftoken"),
                },
                data: {
                    'a': $("#a").val(),
                    'b': $("#b").val(),
                },
                dataType: 'json',
                success: function (output) {
                    alert(output['c']);
                },
                error: function (data) {
                    alert(data.toString());
                }
            });
        }
    </script>
</head>
<body>
    <p>a: <input type="text" id="a" name="a"></p>
    <p>b: <input type="text" id="b" name="b"></p>
    <p><input type="button" id="submit" value="提交" onclick="ajax()"></p>
</body>
</html>
